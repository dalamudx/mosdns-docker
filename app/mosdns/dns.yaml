plugins:
  ################ DNS #################
  # google
  - tag: forward_google
    type: forward
    args:
      concurrent: 2
      upstreams:
        - addr: "tls://dns.google"
          dial_addr: "8.8.8.8"
          enable_pipeline: true # TCP/DoT 启用 RFC 7766 新的 query pipelining 连接复用模式
        - addr: "tls://dns.google"
          dial_addr: "8.8.4.4"
          enable_pipeline: true

  # cloudflare doh dot h3
  - tag: forward_cloudflare
    type: forward
    args:
      concurrent: 2
      upstreams:
        - addr: "tls://1dot1dot1dot1.cloudflare-dns.com"
          dial_addr: "1.1.1.1"
          enable_pipeline: true
        - addr: "tls://1dot1dot1dot1.cloudflare-dns.com"
          dial_addr: "1.0.0.1"
          enable_pipeline: true

      
  # ali doh dot h3
  - tag: forward_alidns
    type: forward
    args:
      concurrent: 2
      upstreams:
        - addr: "tls://dns.alidns.com"
          dial_addr: "223.5.5.5"
          enable_pipeline: false
        - addr: "tls://dns.alidns.com"
          dial_addr: "223.6.6.6"
          enable_pipeline: false
        - tag: ali_doh
          addr: "https://dns.alidns.com/dns-query"
          dial_addr: "223.5.5.5"
          enable_http3: true

  # dnspod doh dot
  - tag: forward_dnspod
    type: forward
    args:
      concurrent: 2
      upstreams:
        - addr: "tls://dot.pub"
          dial_addr: "120.53.53.53"
          enable_pipeline: true
        - addr: "tls://dot.pub"
          dial_addr: "1.12.12.12"
          enable_pipeline: true
  
  - tag: forward_easy
    type: forward
    args:
      concurrent: 1
      upstreams:
        - addr: "https://doh.apad.pro/dns-query"
          bootstrap: "223.5.5.5"
          enable_http3: false 

  # local dns
  - tag: forward_local
    type: forward
    args:
      concurrent: 1
      upstreams: 
        - addr: 10.10.0.1
  
  - tag: forward_remote
    type: forward
    args:
      concurrent: 2 # 并发数。每次请求随机选取 concurrent 个 upstreams 发送请求。
      upstreams:
        - addr: "https://162.159.36.1/dns-query" # cloudflare
        - addr: "https://208.67.222.123/dns-query" # opendns
        - addr: "https://101.101.101.101/dns-query" # TWNIC DNS Quad 101

  # server 失败
  - tag: reject_2
    type: sequence
    args:
      - exec: reject 2

  # 拒绝响应
  - tag: reject_3
    type: sequence
    args:
      - exec: reject 3

  # 不支持的操作
  - tag: reject_5
    type: sequence
    args:
      - exec: reject 5